.ptm-dim-unfocused-paragraphs {
  &[data-ptm-dim-unfocused-editors-behavior="dim"] {
    &:not(.ptm-dim-unfocused-paragraphs-pause-while-scrolling, .ptm-dim-unfocused-paragraphs-pause-while-selecting) .cm-editor:not(.ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-scrolling:not(.ptm-dim-unfocused-paragraphs-pause-while-selecting) .cm-editor:not(.ptm-wheel, .ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-selecting:not(.ptm-dim-unfocused-paragraphs-pause-while-scrolling) .cm-editor:not(.ptm-select, .ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-scrolling.ptm-dim-unfocused-paragraphs-pause-while-selecting .cm-editor:not(.ptm-wheel, .ptm-select, .ptm-first-open) {
      // prettier-ignore
      .CodeMirror-lines:not(.selecting) .CodeMirror-code > :not(.CodeMirror-activeline), .cm-line:not(.cm-active) {
        opacity: var(--dimmed-paragraphs-opacity);
      }
    }
  }

  &[data-ptm-dim-unfocused-editors-behavior="dim-none"],
  &[data-ptm-dim-unfocused-editors-behavior="dim-all"] {
    // prettier-ignore
    &:not(.ptm-dim-unfocused-paragraphs-pause-while-scrolling, .ptm-dim-unfocused-paragraphs-pause-while-selecting) .cm-editor.cm-focused:not(.ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-scrolling:not(.ptm-dim-unfocused-paragraphs-pause-while-selecting) .cm-editor.cm-focused:not(.ptm-wheel, .ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-selecting:not(.ptm-dim-unfocused-paragraphs-pause-while-scrolling) .cm-editor.cm-focused:not(.ptm-select, .ptm-first-open),
      // prettier-ignore
    &.ptm-dim-unfocused-paragraphs-pause-while-scrolling.ptm-dim-unfocused-paragraphs-pause-while-selecting .cm-editor.cm-focused:not(.ptm-wheel, .ptm-select, .ptm-first-open) {
      // prettier-ignore
      .CodeMirror-lines:not(.selecting) .CodeMirror-code > :not(.CodeMirror-activeline), .cm-line:not(.cm-active) {
        opacity: var(--dimmed-paragraphs-opacity);
      }
    }
  }

  // prettier-ignore
  &[data-ptm-dim-unfocused-editors-behavior="dim-all"] .cm-editor:not(.cm-focused) {
    // prettier-ignore
    .CodeMirror-lines:not(.selecting) .CodeMirror-code, .cm-line {
      opacity: var(--dimmed-paragraphs-opacity);
    }
  }
}

.ptm-max-chars-per-line {
  .cm-sizer {
    max-width: var(--max-chars-per-line);
    margin: auto;
  }
}

.ptm-fullscreen-writing-focus-vignette {
  .ptm-fullscreen-writing-focus-element {
    background-color: var(--background-primary);
    box-shadow: 0 0 200px rgba(0, 0, 0, 0.9) inset;

    .view-header,
    .view-content {
      background-color: transparent;
    }

    .view-header .view-header-title-container:after {
      background: transparent;
    }
  }
}

.ptm-highlight-line {
  #ptm-typewriter-line {
    display: block;
    position: absolute;
    left: 0;
    width: 100%;
    pointer-events: none;

    &.ptm-typewriter-line-box {
      background-color: var(--typewriter-line-color);
      mix-blend-mode: screen;
    }

    &.ptm-typewriter-line-underline {
      border-bottom: var(--typewriter-line-underline-thickness) solid
        var(--typewriter-line-color);
    }
  }

  &.ptm-highlight-line-only-in-active-editor {
    .cm-editor:not(.cm-focused) {
      #ptm-typewriter-line {
        display: none;
      }
    }
  }

  .ptm-wheel {
    #ptm-typewriter-line {
      display: none;
    }
  }

  .cm-editor.ptm-first-open {
    #ptm-typewriter-line {
      display: none;
    }
  }
}

.typewriter-mode-setting.setting-item.is-disabled {
  opacity: 0.5;
}
